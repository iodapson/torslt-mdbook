<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>AsRef &amp; AsMut - Tour of Rust&#x27;s Standard Library Traits (in mdbook!)</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><li class="part-title">Tour of Rust's Standard Library Traits</li><li class="chapter-item "><a href="../intro.html"><strong aria-hidden="true">1.</strong> Intro</a></li><li class="chapter-item "><a href="../chapter-1/trait-basics.html"><strong aria-hidden="true">2.</strong> Trait Basics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-1/trait-items.html"><strong aria-hidden="true">2.1.</strong> Trait Items</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-1/self.html"><strong aria-hidden="true">2.1.1.</strong> Self</a></li><li class="chapter-item "><a href="../chapter-1/functions.html"><strong aria-hidden="true">2.1.2.</strong> Functions</a></li><li class="chapter-item "><a href="../chapter-1/methods.html"><strong aria-hidden="true">2.1.3.</strong> Methods</a></li><li class="chapter-item "><a href="../chapter-1/associated-types.html"><strong aria-hidden="true">2.1.4.</strong> Associated Types</a></li><li class="chapter-item "><a href="../chapter-1/generic-parameters.html"><strong aria-hidden="true">2.1.5.</strong> Generic Parameters</a></li><li class="chapter-item "><a href="../chapter-1/generic-types-vs-associated-types.html"><strong aria-hidden="true">2.1.6.</strong> Generic Types vs Associated Types</a></li></ol></li><li class="chapter-item "><a href="../chapter-1/scope.html"><strong aria-hidden="true">2.2.</strong> Scope</a></li><li class="chapter-item "><a href="../chapter-1/derive-macros.html"><strong aria-hidden="true">2.3.</strong> Derive Macros</a></li><li class="chapter-item "><a href="../chapter-1/default-impls.html"><strong aria-hidden="true">2.4.</strong> Default Impls</a></li><li class="chapter-item "><a href="../chapter-1/generic-blanket-impls.html"><strong aria-hidden="true">2.5.</strong> Generic Blanket Impls</a></li><li class="chapter-item "><a href="../chapter-1/subtraits--supertraits.html"><strong aria-hidden="true">2.6.</strong> Subtraits & Supertraits</a></li><li class="chapter-item "><a href="../chapter-1/trait-objects.html"><strong aria-hidden="true">2.7.</strong> Trait Objects</a></li><li class="chapter-item "><a href="../chapter-1/marker-traits.html"><strong aria-hidden="true">2.8.</strong> Marker Traits</a></li><li class="chapter-item "><a href="../chapter-1/auto-traits.html"><strong aria-hidden="true">2.9.</strong> Auto Traits</a></li><li class="chapter-item "><a href="../chapter-1/unsafe-traits.html"><strong aria-hidden="true">2.10.</strong> Unsafe Traits</a></li></ol></li><li class="chapter-item "><a href="../chapter-2/auto-traits-1.html"><strong aria-hidden="true">3.</strong> Auto Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-2/send--sync.html"><strong aria-hidden="true">3.1.</strong> Send & Sync</a></li><li class="chapter-item "><a href="../chapter-2/sized.html"><strong aria-hidden="true">3.2.</strong> Sized</a></li></ol></li><li class="chapter-item "><a href="../chapter-3/general-traits.html"><strong aria-hidden="true">4.</strong> General Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-3/default.html"><strong aria-hidden="true">4.1.</strong> Default</a></li><li class="chapter-item "><a href="../chapter-3/clone.html"><strong aria-hidden="true">4.2.</strong> Clone</a></li><li class="chapter-item "><a href="../chapter-3/copy.html"><strong aria-hidden="true">4.3.</strong> Copy</a></li><li class="chapter-item "><a href="../chapter-3/any.html"><strong aria-hidden="true">4.4.</strong> Any</a></li></ol></li><li class="chapter-item "><a href="../chapter-4/formatting-traits.html"><strong aria-hidden="true">5.</strong> Formatting Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-4/display--tostring.html"><strong aria-hidden="true">5.1.</strong> Display & ToString</a></li><li class="chapter-item "><a href="../chapter-4/debug.html"><strong aria-hidden="true">5.2.</strong> Debug</a></li></ol></li><li class="chapter-item "><a href="../chapter-5/operator-traits.html"><strong aria-hidden="true">6.</strong> Operator Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-5/comparison-traits.html"><strong aria-hidden="true">6.1.</strong> Comparison Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-5/partialeq--eq.html"><strong aria-hidden="true">6.1.1.</strong> PartialEq & Eq</a></li><li class="chapter-item "><a href="../chapter-5/hash.html"><strong aria-hidden="true">6.1.2.</strong> Hash</a></li><li class="chapter-item "><a href="../chapter-5/partialord--ord.html"><strong aria-hidden="true">6.1.3.</strong> PartialOrd & Ord</a></li></ol></li><li class="chapter-item "><a href="../chapter-5/arithmetic-traits.html"><strong aria-hidden="true">6.2.</strong> Arithmetic Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-5/add--addassign.html"><strong aria-hidden="true">6.2.1.</strong> Add & AddAssign</a></li></ol></li><li class="chapter-item "><a href="../chapter-5/closure-traits.html"><strong aria-hidden="true">6.3.</strong> Closure Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-5/fnonce-fnmut--fn.html"><strong aria-hidden="true">6.3.1.</strong> FnOnce, FnMut, & Fn</a></li></ol></li><li class="chapter-item "><a href="../chapter-5/other-traits.html"><strong aria-hidden="true">6.4.</strong> Other Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-5/deref--derefmut.html"><strong aria-hidden="true">6.4.1.</strong> Deref & DerefMut</a></li><li class="chapter-item "><a href="../chapter-5/index--indexmut.html"><strong aria-hidden="true">6.4.2.</strong> Index & IndexMut</a></li><li class="chapter-item "><a href="../chapter-5/drop.html"><strong aria-hidden="true">6.4.3.</strong> Drop</a></li></ol></li></ol></li><li class="chapter-item "><a href="../chapter-6/from--into.html"><strong aria-hidden="true">7.</strong> Conversion Traits</a></li><li class="chapter-item "><a href="../chapter-7/error.html"><strong aria-hidden="true">8.</strong> Error Handling</a></li><li class="chapter-item expanded "><a href="../chapter-8/conversion-traits-continued.html"><strong aria-hidden="true">9.</strong> Conversion Traits Continued</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-8/tryfrom--tryinto.html"><strong aria-hidden="true">9.1.</strong> TryFrom & TryInto</a></li><li class="chapter-item "><a href="../chapter-8/fromstr.html"><strong aria-hidden="true">9.2.</strong> FromStr</a></li><li class="chapter-item expanded "><a href="../chapter-8/asref--asmut.html" class="active"><strong aria-hidden="true">9.3.</strong> AsRef & AsMut</a></li><li class="chapter-item "><a href="../chapter-8/borrow--borrowmut.html"><strong aria-hidden="true">9.4.</strong> Borrow & BorrowMut</a></li><li class="chapter-item "><a href="../chapter-8/toowned.html"><strong aria-hidden="true">9.5.</strong> ToOwned</a></li></ol></li><li class="chapter-item "><a href="../chapter-9/iteration-traits.html"><strong aria-hidden="true">10.</strong> Iteration Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../chapter-9/iterator.html"><strong aria-hidden="true">10.1.</strong> Iterator</a></li><li class="chapter-item "><a href="../chapter-9/intoiterator.html"><strong aria-hidden="true">10.2.</strong> IntoIterator</a></li><li class="chapter-item "><a href="../chapter-9/fromiterator.html"><strong aria-hidden="true">10.3.</strong> FromIterator</a></li></ol></li><li class="chapter-item "><a href="../chapter-10/read--write.html"><strong aria-hidden="true">11.</strong> I/O Traits</a></li><li class="chapter-item "><a href="../chapter-11/conclusion.html"><strong aria-hidden="true">12.</strong> Conclusion</a></li><li class="chapter-item "><a href="../discuss.html"><strong aria-hidden="true">13.</strong> Discuss</a></li><li class="chapter-item "><a href="../notifications.html"><strong aria-hidden="true">14.</strong> Notifications</a></li><li class="chapter-item "><a href="../further-reading.html"><strong aria-hidden="true">15.</strong> Further Reading</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Tour of Rust&#x27;s Standard Library Traits (in mdbook!)</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h3 id="asref--asmut"><a class="header" href="#asref--asmut">AsRef &amp; AsMut</a></h3>
<p>Prerequisites</p>
<ul>
<li><a href="..chapter-1/self.html">Self</a></li>
<li><a href="../chapter-1/methods.html">Methods</a></li>
<li><a href="../chapter-2/sized.html">Sized</a></li>
<li><a href="../chapter-1/generic-parameters.html">Generic Parameters</a></li>
<li><a href="../chapter-5/deref--derefmut.html">Deref &amp; DerefMut</a></li>
</ul>
<pre><code class="language-rust">trait AsRef&lt;T: ?Sized&gt; {
    fn as_ref(&amp;self) -&gt; &amp;T;
}
trait AsMut&lt;T: ?Sized&gt; {
    fn as_mut(&amp;mut self) -&gt; &amp;mut T;
}
</code></pre>
<p><code>AsRef</code> is for cheap reference to reference conversions. However, one of the most common ways it's used is to make functions generic over whether they take ownership or not:</p>
<pre><code class="language-rust">// accepts:
//  - &amp;str
//  - &amp;String
fn takes_str(s: &amp;str) {
    // use &amp;str
}
// accepts:
//  - &amp;str
//  - &amp;String
//  - String
fn takes_asref_str&lt;S: AsRef&lt;str&gt;&gt;(s: S) {
    let s: &amp;str = s.as_ref();
    // use &amp;str
}
fn example(slice: &amp;str, borrow: &amp;String, owned: String) {
    takes_str(slice);
    takes_str(borrow);
    takes_str(owned); // ❌
    takes_asref_str(slice);
    takes_asref_str(borrow);
    takes_asref_str(owned); // ✅
}
</code></pre>
<p>The other most common use-case is returning a reference to inner private data wrapped by a type which protects some invariant. A good example from the standard library is <code>String</code> which is just a wrapper around <code>Vec&lt;u8&gt;</code>:</p>
<pre><code class="language-rust">struct String {
    vec: Vec&lt;u8&gt;,
}
</code></pre>
<p>This inner <code>Vec</code> cannot be made public because if it was people could mutate any byte and break the <code>String</code>'s valid UTF-8 encoding. However, it's safe to expose an immutable read-only reference to the inner byte array, hence this impl:</p>
<pre><code class="language-rust">impl AsRef&lt;[u8]&gt; for String;
</code></pre>
<p>Generally, it often only makes sense to impl <code>AsRef</code> for a type if it wraps some other type to either provide additional functionality around the inner type or protect some invariant on the inner type.
Let's examine a example of bad <code>AsRef</code> impls:</p>
<pre><code class="language-rust">struct User {
    name: String,
    age: u32,
}
impl AsRef&lt;String&gt; for User {
    fn as_ref(&amp;self) -&gt; &amp;String {
        &amp;self.name
    }
}
impl AsRef&lt;u32&gt; for User {
    fn as_ref(&amp;self) -&gt; &amp;u32 {
        &amp;self.age
    }
}
</code></pre>
<p>This works and kinda makes sense at first, but quickly falls apart if we add more members to <code>User</code>:</p>
<pre><code class="language-rust">struct User {
    name: String,
    email: String,
    age: u32,
    height: u32,
}
impl AsRef&lt;String&gt; for User {
    fn as_ref(&amp;self) -&gt; &amp;String {
        // uh, do we return name or email here?
    }
}
impl AsRef&lt;u32&gt; for User {
    fn as_ref(&amp;self) -&gt; &amp;u32 {
        // uh, do we return age or height here?
    }
}
</code></pre>
<p>A <code>User</code> is composed of <code>String</code>s and <code>u32</code>s but it's not really the same thing as a <code>String</code> or a <code>u32</code>. Even if we had much more specific types:</p>
<pre><code class="language-rust">struct User {
    name: Name,
    email: Email,
    age: Age,
    height: Height,
}
</code></pre>
<p>It wouldn't make much sense to impl <code>AsRef</code> for any of those because <code>AsRef</code> is for cheap reference to reference conversions between semantically equivalent things, and <code>Name</code>, <code>Email</code>, <code>Age</code>, and <code>Height</code> by themselves are not the same thing as a <code>User</code>.</p>
<p>A good example where we would impl <code>AsRef</code> would be if we introduced a new type <code>Moderator</code> that just wrapped a <code>User</code> and added some moderation specific privileges:</p>
<pre><code class="language-rust">struct User {
    name: String,
    age: u32,
}
// unfortunately the standard library cannot provide
// a generic blanket impl to save us from this boilerplate
impl AsRef&lt;User&gt; for User {
    fn as_ref(&amp;self) -&gt; &amp;User {
        self
    }
}
enum Privilege {
    BanUsers,
    EditPosts,
    DeletePosts,
}
// although Moderators have some special
// privileges they are still regular Users
// and should be able to do all the same stuff
struct Moderator {
    user: User,
    privileges: Vec&lt;Privilege&gt;
}
impl AsRef&lt;Moderator&gt; for Moderator {
    fn as_ref(&amp;self) -&gt; &amp;Moderator {
        self
    }
}
impl AsRef&lt;User&gt; for Moderator {
    fn as_ref(&amp;self) -&gt; &amp;User {
        &amp;self.user
    }
}
// this should be callable with Users
// and Moderators (who are also Users)
fn create_post&lt;U: AsRef&lt;User&gt;&gt;(u: U) {
    let user = u.as_ref();
    // etc
}
fn example(user: User, moderator: Moderator) {
    create_post(&amp;user);
    create_post(&amp;moderator); // ✅
}
</code></pre>
<p>This works because <code>Moderator</code>s are just <code>User</code>s. Here's the example from the <code>Deref</code> section except using <code>AsRef</code> instead:</p>
<pre><code class="language-rust">use std::convert::AsRef;
struct Human {
    health_points: u32,
}
impl AsRef&lt;Human&gt; for Human {
    fn as_ref(&amp;self) -&gt; &amp;Human {
        self
    }
}
enum Weapon {
    Spear,
    Axe,
    Sword,
}
// a Soldier is just a Human with a Weapon
struct Soldier {
    human: Human,
    weapon: Weapon,
}
impl AsRef&lt;Soldier&gt; for Soldier {
    fn as_ref(&amp;self) -&gt; &amp;Soldier {
        self
    }
}
impl AsRef&lt;Human&gt; for Soldier {
    fn as_ref(&amp;self) -&gt; &amp;Human {
        &amp;self.human
    }
}
enum Mount {
    Horse,
    Donkey,
    Cow,
}
// a Knight is just a Soldier with a Mount
struct Knight {
    soldier: Soldier,
    mount: Mount,
}
impl AsRef&lt;Knight&gt; for Knight {
    fn as_ref(&amp;self) -&gt; &amp;Knight {
        self
    }
}
impl AsRef&lt;Soldier&gt; for Knight {
    fn as_ref(&amp;self) -&gt; &amp;Soldier {
        &amp;self.soldier
    }
}
impl AsRef&lt;Human&gt; for Knight {
    fn as_ref(&amp;self) -&gt; &amp;Human {
        &amp;self.soldier.human
    }
}
enum Spell {
    MagicMissile,
    FireBolt,
    ThornWhip,
}
// a Mage is just a Human who can cast Spells
struct Mage {
    human: Human,
    spells: Vec&lt;Spell&gt;,
}
impl AsRef&lt;Mage&gt; for Mage {
    fn as_ref(&amp;self) -&gt; &amp;Mage {
        self
    }
}
impl AsRef&lt;Human&gt; for Mage {
    fn as_ref(&amp;self) -&gt; &amp;Human {
        &amp;self.human
    }
}
enum Staff {
    Wooden,
    Metallic,
    Plastic,
}
// a Wizard is just a Mage with a Staff
struct Wizard {
    mage: Mage,
    staff: Staff,
}
impl AsRef&lt;Wizard&gt; for Wizard {
    fn as_ref(&amp;self) -&gt; &amp;Wizard {
        self
    }
}
impl AsRef&lt;Mage&gt; for Wizard {
    fn as_ref(&amp;self) -&gt; &amp;Mage {
        &amp;self.mage
    }
}
impl AsRef&lt;Human&gt; for Wizard {
    fn as_ref(&amp;self) -&gt; &amp;Human {
        &amp;self.mage.human
    }
}
fn borrows_human&lt;H: AsRef&lt;Human&gt;&gt;(human: H) {}
fn borrows_soldier&lt;S: AsRef&lt;Soldier&gt;&gt;(soldier: S) {}
fn borrows_knight&lt;K: AsRef&lt;Knight&gt;&gt;(knight: K) {}
fn borrows_mage&lt;M: AsRef&lt;Mage&gt;&gt;(mage: M) {}
fn borrows_wizard&lt;W: AsRef&lt;Wizard&gt;&gt;(wizard: W) {}
fn example(human: Human, soldier: Soldier, knight: Knight, mage: Mage, wizard: Wizard) {
    // all types can be used as Humans
    borrows_human(&amp;human);
    borrows_human(&amp;soldier);
    borrows_human(&amp;knight);
    borrows_human(&amp;mage);
    borrows_human(&amp;wizard);
    // Knights can be used as Soldiers
    borrows_soldier(&amp;soldier);
    borrows_soldier(&amp;knight);
    // Wizards can be used as Mages
    borrows_mage(&amp;mage);
    borrows_mage(&amp;wizard);
    // Knights &amp; Wizards passed as themselves
    borrows_knight(&amp;knight);
    borrows_wizard(&amp;wizard);
}
</code></pre>
<p><code>Deref</code> didn't work in the prior version of the example above because deref coercion is an implicit conversion between types which leaves room for people to mistakenly formulate the wrong ideas and expectations for how it will behave. <code>AsRef</code> works above because it makes the conversion between types explicit and there's no room leftover to develop any wrong ideas or expectations.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../chapter-8/fromstr.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../chapter-8/borrow--borrowmut.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../chapter-8/fromstr.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../chapter-8/borrow--borrowmut.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
